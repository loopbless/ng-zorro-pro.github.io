function _createForOfIteratorHelper(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=_unsupportedIterableToArray(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r,o=!0,a=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){a=!0,r=t},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw r}}}}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(c){r=!0,o=c}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{rCdd:function(t,e,n){"use strict";n.r(e),n.d(e,"EditorModule",(function(){return we}));var i=n("ofXK"),r=n("tyNb"),o=(n("xgIS"),n("LRne"),n("eIep")),a=n("lJxs"),s=n("1G5W");n("pLZG");var c=n("fXoL"),l=n("vxfF"),h=n("nLfN"),d=n("8LU1"),u=n("XNiG"),f=n("quSY"),g=n("HDdC"),p=n("D0XW"),v=n("Y7HM");function y(t){var e=t.subscriber,n=t.counter,i=t.period;e.next(n),this.schedule({subscriber:e,counter:n+1,period:i},i)}var _=n("eNwd"),b=n("VRyK"),m=n("JX91"),D=n("IzEk"),k=n("vkgz"),x=n("cH1L");function w(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function S(t,e){var n=e?"":"none";w(t.style,{touchAction:e?"":"none",webkitUserDrag:e?"":"none",webkitTapHighlightColor:e?"":"transparent",userSelect:n,msUserSelect:n,webkitUserSelect:n,MozUserSelect:n})}function z(t){var e=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*e}function P(t,e){return t.getPropertyValue(e).split(",").map((function(t){return t.trim()}))}function C(t){var e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}}function E(t,e,n){var i=t.top,r=t.bottom,o=t.left,a=t.right;return n>=i&&n<=r&&e>=o&&e<=a}function I(t,e,n){t.top+=e,t.bottom=t.top+t.height,t.left+=n,t.right=t.left+t.width}function R(t,e,n,i){var r=t.top,o=t.right,a=t.bottom,s=t.left,c=t.width*e,l=t.height*e;return i>r-l&&i<a+l&&n>s-c&&n<o+c}var O=Object(h.e)({passive:!0}),G=Object(h.e)({passive:!1}),T=function(){function t(e,n,i,r,o,a){var s=this;_classCallCheck(this,t),this._config=n,this._document=i,this._ngZone=r,this._viewportRuler=o,this._dragDropRegistry=a,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._moveEvents=new u.a,this._pointerMoveSubscription=f.a.EMPTY,this._pointerUpSubscription=f.a.EMPTY,this._scrollSubscription=f.a.EMPTY,this._resizeSubscription=f.a.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new u.a,this.started=new u.a,this.released=new u.a,this.ended=new u.a,this.entered=new u.a,this.exited=new u.a,this.dropped=new u.a,this.moved=this._moveEvents.asObservable(),this._pointerDown=function(t){if(s.beforeStarted.next(),s._handles.length){var e=s._handles.find((function(e){var n=t.target;return!!n&&(n===e||e.contains(n))}));!e||s._disabledHandles.has(e)||s.disabled||s._initializeDragSequence(e,t)}else s.disabled||s._initializeDragSequence(s._rootElement,t)},this._pointerMove=function(t){t.preventDefault();var e=s._getPointerPositionOnPage(t);if(s._hasStartedDragging){s._boundaryElement&&(s._previewRect&&(s._previewRect.width||s._previewRect.height)||(s._previewRect=(s._preview||s._rootElement).getBoundingClientRect()));var n=s._getConstrainedPointerPosition(e);if(s._hasMoved=!0,s._updatePointerDirectionDelta(n),s._dropContainer)s._updateActiveDropContainer(n);else{var i=s._activeTransform;i.x=n.x-s._pickupPositionOnPage.x+s._passiveTransform.x,i.y=n.y-s._pickupPositionOnPage.y+s._passiveTransform.y,s._applyRootElementTransform(i.x,i.y),"undefined"!=typeof SVGElement&&s._rootElement instanceof SVGElement&&s._rootElement.setAttribute("transform","translate(".concat(i.x," ").concat(i.y,")"))}s._moveEvents.observers.length&&s._ngZone.run((function(){s._moveEvents.next({source:s,pointerPosition:n,event:t,distance:s._getDragDistance(n),delta:s._pointerDirectionDelta})}))}else if(Math.abs(e.x-s._pickupPositionOnPage.x)+Math.abs(e.y-s._pickupPositionOnPage.y)>=s._config.dragStartThreshold){if(!(Date.now()>=s._dragStartTime+s._getDragStartDelay(t)))return void s._endDragSequence(t);s._dropContainer&&s._dropContainer.isDragging()||(s._hasStartedDragging=!0,s._ngZone.run((function(){return s._startDragSequence(t)})))}},this._pointerUp=function(t){s._endDragSequence(t)},this.withRootElement(e),a.registerDragItem(this)}return _createClass(t,[{key:"getPlaceholderElement",value:function(){return this._placeholder}},{key:"getRootElement",value:function(){return this._rootElement}},{key:"getVisibleElement",value:function(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}},{key:"withHandles",value:function(t){return this._handles=t.map((function(t){return Object(d.e)(t)})),this._handles.forEach((function(t){return S(t,!1)})),this._toggleNativeDragInteractions(),this}},{key:"withPreviewTemplate",value:function(t){return this._previewTemplate=t,this}},{key:"withPlaceholderTemplate",value:function(t){return this._placeholderTemplate=t,this}},{key:"withRootElement",value:function(t){var e=this,n=Object(d.e)(t);return n!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular((function(){n.addEventListener("mousedown",e._pointerDown,G),n.addEventListener("touchstart",e._pointerDown,O)})),this._initialTransform=void 0,this._rootElement=n),this}},{key:"withBoundaryElement",value:function(t){var e=this;return this._boundaryElement=t?Object(d.e)(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe((function(){return e._containInsideBoundaryOnResize()}))),this}},{key:"dispose",value:function(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&A(this._rootElement),A(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._boundaryElement=this._rootElement=this._placeholderTemplate=this._previewTemplate=this._anchor=null}},{key:"isDragging",value:function(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}},{key:"reset",value:function(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}},{key:"disableHandle",value:function(t){this._handles.indexOf(t)>-1&&this._disabledHandles.add(t)}},{key:"enableHandle",value:function(t){this._disabledHandles.delete(t)}},{key:"withDirection",value:function(t){return this._direction=t,this}},{key:"_withDropContainer",value:function(t){this._dropContainer=t}},{key:"getFreeDragPosition",value:function(){var t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}},{key:"setFreeDragPosition",value:function(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}},{key:"_sortFromLastPointerPosition",value:function(){var t=this._pointerPositionAtLastDirectionChange;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t))}},{key:"_removeSubscriptions",value:function(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}},{key:"_destroyPreview",value:function(){this._preview&&A(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}},{key:"_destroyPlaceholder",value:function(){this._placeholder&&A(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}},{key:"_endDragSequence",value:function(t){var e=this;this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging&&(this.released.next({source:this}),this._dropContainer?(this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then((function(){e._cleanupDragArtifacts(t),e._cleanupCachedDimensions(),e._dragDropRegistry.stopDragging(e)}))):(this._passiveTransform.x=this._activeTransform.x,this._passiveTransform.y=this._activeTransform.y,this._ngZone.run((function(){e.ended.next({source:e,distance:e._getDragDistance(e._getPointerPositionOnPage(t))})})),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this))))}},{key:"_startDragSequence",value:function(t){if(this.started.next({source:this}),B(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions(),this._dropContainer){var e=this._rootElement,n=e.parentNode,i=this._preview=this._createPreviewElement(),r=this._placeholder=this._createPlaceholderElement(),o=this._anchor=this._anchor||this._document.createComment("");n.insertBefore(o,e),e.style.display="none",this._document.body.appendChild(n.replaceChild(r,e)),(a=this._document,a.fullscreenElement||a.webkitFullscreenElement||a.mozFullScreenElement||a.msFullscreenElement||a.body).appendChild(i),this._dropContainer.start(),this._initialContainer=this._dropContainer,this._initialIndex=this._dropContainer.getItemIndex(this)}else this._initialContainer=this._initialIndex=void 0;var a}},{key:"_initializeDragSequence",value:function(t,e){var n=this;e.stopPropagation();var i=this.isDragging(),r=B(e),o=!r&&0!==e.button,a=this._rootElement,s=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now();if(e.target&&e.target.draggable&&"mousedown"===e.type&&e.preventDefault(),!(i||o||s)){this._handles.length&&(this._rootElementTapHighlight=a.style.webkitTapHighlightColor,a.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scroll.pipe(Object(m.a)(null)).subscribe((function(){n._updateOnScroll()})),this._boundaryElement&&(this._boundaryRect=C(this._boundaryElement));var c=this._previewTemplate;this._pickupPositionInElement=c&&c.template&&!c.matchSize?{x:0,y:0}:this._getPointerPositionInElement(t,e);var l=this._pickupPositionOnPage=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:l.x,y:l.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}}},{key:"_cleanupDragArtifacts",value:function(t){var e=this;this._rootElement.style.display="",this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=void 0,this._ngZone.run((function(){var n=e._dropContainer,i=n.getItemIndex(e),r=e._getPointerPositionOnPage(t),o=e._getDragDistance(e._getPointerPositionOnPage(t)),a=n._isOverContainer(r.x,r.y);e.ended.next({source:e,distance:o}),e.dropped.next({item:e,currentIndex:i,previousIndex:e._initialIndex,container:n,previousContainer:e._initialContainer,isPointerOverContainer:a,distance:o}),n.drop(e,i,e._initialContainer,a,o,e._initialIndex),e._dropContainer=e._initialContainer}))}},{key:"_updateActiveDropContainer",value:function(t){var e=this,n=t.x,i=t.y,r=this._initialContainer._getSiblingContainerFromPosition(this,n,i);!r&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,i)&&(r=this._initialContainer),r&&r!==this._dropContainer&&this._ngZone.run((function(){e.exited.next({item:e,container:e._dropContainer}),e._dropContainer.exit(e),e._dropContainer=r,e._dropContainer.enter(e,n,i,r===e._initialContainer&&r.sortingDisabled?e._initialIndex:void 0),e.entered.next({item:e,container:r,currentIndex:r.getItemIndex(e)})})),this._dropContainer._startScrollingIfNecessary(n,i),this._dropContainer._sortItem(this,n,i,this._pointerDirectionDelta),this._preview.style.transform=M(n-this._pickupPositionInElement.x,i-this._pickupPositionInElement.y)}},{key:"_createPreviewElement",value:function(){var t,e=this._previewTemplate,n=this.previewClass,i=e?e.template:null;if(i){var r=e.viewContainer.createEmbeddedView(i,e.context);r.detectChanges(),t=F(r,this._document),this._previewRef=r,e.matchSize?$(t,this._rootElement):t.style.transform=M(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{var o=this._rootElement;$(t=L(o),o)}return w(t.style,{pointerEvents:"none",margin:"0",position:"fixed",top:"0",left:"0",zIndex:"".concat(this._config.zIndex||1e3)}),S(t,!1),t.classList.add("cdk-drag-preview"),t.setAttribute("dir",this._direction),n&&(Array.isArray(n)?n.forEach((function(e){return t.classList.add(e)})):t.classList.add(n)),t}},{key:"_animatePreviewToPlaceholder",value:function(){var t=this;if(!this._hasMoved)return Promise.resolve();var e=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._preview.style.transform=M(e.left,e.top);var n=function(t){var e=getComputedStyle(t),n=P(e,"transition-property"),i=n.find((function(t){return"transform"===t||"all"===t}));if(!i)return 0;var r=n.indexOf(i),o=P(e,"transition-duration"),a=P(e,"transition-delay");return z(o[r])+z(a[r])}(this._preview);return 0===n?Promise.resolve():this._ngZone.runOutsideAngular((function(){return new Promise((function(e){var i=function n(i){(!i||i.target===t._preview&&"transform"===i.propertyName)&&(t._preview.removeEventListener("transitionend",n),e(),clearTimeout(r))},r=setTimeout(i,1.5*n);t._preview.addEventListener("transitionend",i)}))}))}},{key:"_createPlaceholderElement",value:function(){var t,e=this._placeholderTemplate,n=e?e.template:null;return n?(this._placeholderRef=e.viewContainer.createEmbeddedView(n,e.context),this._placeholderRef.detectChanges(),t=F(this._placeholderRef,this._document)):t=L(this._rootElement),t.classList.add("cdk-drag-placeholder"),t}},{key:"_getPointerPositionInElement",value:function(t,e){var n=this._rootElement.getBoundingClientRect(),i=t===this._rootElement?null:t,r=i?i.getBoundingClientRect():n,o=B(e)?e.targetTouches[0]:e;return{x:r.left-n.left+(o.pageX-r.left-this._scrollPosition.left),y:r.top-n.top+(o.pageY-r.top-this._scrollPosition.top)}}},{key:"_getPointerPositionOnPage",value:function(t){var e=B(t)?t.touches[0]||t.changedTouches[0]:t;return{x:e.pageX-this._scrollPosition.left,y:e.pageY-this._scrollPosition.top}}},{key:"_getConstrainedPointerPosition",value:function(t){var e=this.constrainPosition?this.constrainPosition(t,this):t,n=this._dropContainer?this._dropContainer.lockAxis:null;if("x"===this.lockAxis||"x"===n?e.y=this._pickupPositionOnPage.y:"y"!==this.lockAxis&&"y"!==n||(e.x=this._pickupPositionOnPage.x),this._boundaryRect){var i=this._pickupPositionInElement,r=i.x,o=i.y,a=this._boundaryRect,s=this._previewRect,c=a.top+o,l=a.bottom-(s.height-o);e.x=j(e.x,a.left+r,a.right-(s.width-r)),e.y=j(e.y,c,l)}return e}},{key:"_updatePointerDirectionDelta",value:function(t){var e=t.x,n=t.y,i=this._pointerDirectionDelta,r=this._pointerPositionAtLastDirectionChange,o=Math.abs(e-r.x),a=Math.abs(n-r.y);return o>this._config.pointerDirectionChangeThreshold&&(i.x=e>r.x?1:-1,r.x=e),a>this._config.pointerDirectionChangeThreshold&&(i.y=n>r.y?1:-1,r.y=n),i}},{key:"_toggleNativeDragInteractions",value:function(){if(this._rootElement&&this._handles){var t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,S(this._rootElement,t))}}},{key:"_removeRootElementListeners",value:function(t){t.removeEventListener("mousedown",this._pointerDown,G),t.removeEventListener("touchstart",this._pointerDown,O)}},{key:"_applyRootElementTransform",value:function(t,e){var n=M(t,e);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform||""),this._rootElement.style.transform=this._initialTransform?n+" "+this._initialTransform:n}},{key:"_getDragDistance",value:function(t){var e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}},{key:"_cleanupCachedDimensions",value:function(){this._boundaryRect=this._previewRect=void 0}},{key:"_containInsideBoundaryOnResize",value:function(){var t=this._passiveTransform,e=t.x,n=t.y;if(!(0===e&&0===n||this.isDragging())&&this._boundaryElement){var i=this._boundaryElement.getBoundingClientRect(),r=this._rootElement.getBoundingClientRect();if(!(0===i.width&&0===i.height||0===r.width&&0===r.height)){var o=i.left-r.left,a=r.right-i.right,s=i.top-r.top,c=r.bottom-i.bottom;i.width>r.width?(o>0&&(e+=o),a>0&&(e-=a)):e=0,i.height>r.height?(s>0&&(n+=s),c>0&&(n-=c)):n=0,e===this._passiveTransform.x&&n===this._passiveTransform.y||this.setFreeDragPosition({y:n,x:e})}}}},{key:"_getDragStartDelay",value:function(t){var e=this.dragStartDelay;return"number"==typeof e?e:B(t)?e.touch:e?e.mouse:0}},{key:"_updateOnScroll",value:function(){var t=this._scrollPosition,e=this._viewportRuler.getViewportScrollPosition();t&&this._boundaryRect&&I(this._boundaryRect,t.top-e.top,t.left-e.left),this._scrollPosition=e}},{key:"disabled",get:function(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)},set:function(t){var e=Object(d.c)(t);e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions())}}]),t}();function M(t,e){return"translate3d(".concat(Math.round(t),"px, ").concat(Math.round(e),"px, 0)")}function L(t){var e=t.cloneNode(!0),n=e.querySelectorAll("[id]"),i=t.querySelectorAll("canvas");e.removeAttribute("id");for(var r=0;r<n.length;r++)n[r].removeAttribute("id");if(i.length)for(var o=e.querySelectorAll("canvas"),a=0;a<i.length;a++){var s=o[a].getContext("2d");s&&s.drawImage(i[a],0,0)}return e}function j(t,e,n){return Math.max(e,Math.min(n,t))}function A(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function B(t){return"t"===t.type[0]}function F(t,e){var n=t.rootNodes;if(1===n.length&&n[0].nodeType===e.ELEMENT_NODE)return n[0];var i=e.createElement("div");return n.forEach((function(t){return i.appendChild(t)})),i}function $(t,e){var n=e.getBoundingClientRect();t.style.width="".concat(n.width,"px"),t.style.height="".concat(n.height,"px"),t.style.transform=M(n.left,n.top)}function H(t,e){return Math.max(0,Math.min(e,t))}var X=function(){function t(e,n,i,r,o){var a=this;_classCallCheck(this,t),this._dragDropRegistry=n,this._ngZone=r,this._viewportRuler=o,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.enterPredicate=function(){return!0},this.beforeStarted=new u.a,this.entered=new u.a,this.exited=new u.a,this.dropped=new u.a,this.sorted=new u.a,this._isDragging=!1,this._itemPositions=[],this._parentPositions=new Map,this._previousSwap={drag:null,delta:0},this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=f.a.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new u.a,this._cachedShadowRoot=null,this._startScrollInterval=function(){a._stopScrolling(),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.a;return(!Object(v.a)(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=p.a),new g.a((function(n){return n.add(e.schedule(y,t,{subscriber:n,counter:0,period:t})),n}))}(0,_.a).pipe(Object(s.a)(a._stopScrollTimers)).subscribe((function(){var t=a._scrollNode;1===a._verticalScrollDirection?N(t,-2):2===a._verticalScrollDirection&&N(t,2),1===a._horizontalScrollDirection?W(t,-2):2===a._horizontalScrollDirection&&W(t,2)}))},this.element=Object(d.e)(e),this._document=i,this.withScrollableParents([this.element]),n.registerDropContainer(this)}return _createClass(t,[{key:"dispose",value:function(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}},{key:"isDragging",value:function(){return this._isDragging}},{key:"start",value:function(){var t=this,e=Object(d.e)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=e.msScrollSnapType||e.scrollSnapType||"",e.scrollSnapType=e.msScrollSnapType="none",this._cacheItems(),this._siblings.forEach((function(e){return e._startReceiving(t)})),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}},{key:"enter",value:function(t,e,n,i){var r;this.start(),null==i?-1===(r=this.sortingDisabled?this._draggables.indexOf(t):-1)&&(r=this._getItemIndexFromPointerPosition(t,e,n)):r=i;var o=this._activeDraggables,a=o.indexOf(t),s=t.getPlaceholderElement(),c=o[r];if(c===t&&(c=o[r+1]),a>-1&&o.splice(a,1),c&&!this._dragDropRegistry.isDragging(c)){var l=c.getRootElement();l.parentElement.insertBefore(s,l),o.splice(r,0,t)}else Object(d.e)(this.element).appendChild(s),o.push(t);s.style.transform="",this._cacheItemPositions(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}},{key:"exit",value:function(t){this._reset(),this.exited.next({item:t,container:this})}},{key:"drop",value:function(t,e,n,i,r,o){this._reset(),null==o&&(o=n.getItemIndex(t)),this.dropped.next({item:t,currentIndex:e,previousIndex:o,container:this,previousContainer:n,isPointerOverContainer:i,distance:r})}},{key:"withItems",value:function(t){var e=this;return this._draggables=t,t.forEach((function(t){return t._withDropContainer(e)})),this.isDragging()&&this._cacheItems(),this}},{key:"withDirection",value:function(t){return this._direction=t,this}},{key:"connectedTo",value:function(t){return this._siblings=t.slice(),this}},{key:"withOrientation",value:function(t){return this._orientation=t,this}},{key:"withScrollableParents",value:function(t){var e=Object(d.e)(this.element);return this._scrollableElements=-1===t.indexOf(e)?[e].concat(_toConsumableArray(t)):t.slice(),this}},{key:"getItemIndex",value:function(t){return this._isDragging?Y("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,(function(e){return e.drag===t})):this._draggables.indexOf(t)}},{key:"isReceiving",value:function(){return this._activeSiblings.size>0}},{key:"_sortItem",value:function(t,e,n,i){if(!this.sortingDisabled&&R(this._clientRect,.05,e,n)){var r=this._itemPositions,o=this._getItemIndexFromPointerPosition(t,e,n,i);if(!(-1===o&&r.length>0)){var a="horizontal"===this._orientation,s=Y(r,(function(e){return e.drag===t})),c=r[o],l=r[s].clientRect,h=c.clientRect,d=s>o?1:-1;this._previousSwap.drag=c.drag,this._previousSwap.delta=a?i.x:i.y;var u=this._getItemOffsetPx(l,h,d),f=this._getSiblingOffsetPx(s,r,d),g=r.slice();!function(t,e,n){var i=H(e,t.length-1),r=H(n,t.length-1);if(i!==r){for(var o=t[i],a=r<i?-1:1,s=i;s!==r;s+=a)t[s]=t[s+a];t[r]=o}}(r,s,o),this.sorted.next({previousIndex:s,currentIndex:o,container:this,item:t}),r.forEach((function(e,n){if(g[n]!==e){var i=e.drag===t,r=i?u:f,o=i?t.getPlaceholderElement():e.drag.getRootElement();e.offset+=r,a?(o.style.transform="translate3d(".concat(Math.round(e.offset),"px, 0, 0)"),I(e.clientRect,0,r)):(o.style.transform="translate3d(0, ".concat(Math.round(e.offset),"px, 0)"),I(e.clientRect,r,0))}}))}}}},{key:"_startScrollingIfNecessary",value:function(t,e){var n=this;if(!this.autoScrollDisabled){var i,r=0,o=0;if(this._parentPositions.forEach((function(a,s){var c;s!==n._document&&a.clientRect&&!i&&R(a.clientRect,.05,t,e)&&(c=_slicedToArray(function(t,e,n,i){var r=Z(e,i),o=K(e,n),a=0,s=0;if(r){var c=t.scrollTop;1===r?c>0&&(a=1):t.scrollHeight-c>t.clientHeight&&(a=2)}if(o){var l=t.scrollLeft;1===o?l>0&&(s=1):t.scrollWidth-l>t.clientWidth&&(s=2)}return[a,s]}(s,a.clientRect,t,e),2),r=c[0],o=c[1],(r||o)&&(i=s))})),!r&&!o){var a=this._viewportRuler.getViewportSize(),s=a.width,c=a.height,l={width:s,height:c,top:0,right:s,bottom:c,left:0};r=Z(l,e),o=K(l,t),i=window}!i||r===this._verticalScrollDirection&&o===this._horizontalScrollDirection&&i===this._scrollNode||(this._verticalScrollDirection=r,this._horizontalScrollDirection=o,this._scrollNode=i,(r||o)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}}},{key:"_stopScrolling",value:function(){this._stopScrollTimers.next()}},{key:"_cacheParentPositions",value:function(){var t=this;this._parentPositions.clear(),this._parentPositions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),this._scrollableElements.forEach((function(e){var n=C(e);e===t.element&&(t._clientRect=n),t._parentPositions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:n})}))}},{key:"_cacheItemPositions",value:function(){var t="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map((function(t){var e=t.getVisibleElement();return{drag:t,offset:0,clientRect:C(e)}})).sort((function(e,n){return t?e.clientRect.left-n.clientRect.left:e.clientRect.top-n.clientRect.top}))}},{key:"_reset",value:function(){var t=this;this._isDragging=!1;var e=Object(d.e)(this.element).style;e.scrollSnapType=e.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach((function(t){return t.getRootElement().style.transform=""})),this._siblings.forEach((function(e){return e._stopReceiving(t)})),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}},{key:"_getSiblingOffsetPx",value:function(t,e,n){var i="horizontal"===this._orientation,r=e[t].clientRect,o=e[t+-1*n],a=r[i?"width":"height"]*n;if(o){var s=i?"left":"top",c=i?"right":"bottom";-1===n?a-=o.clientRect[s]-r[c]:a+=r[s]-o.clientRect[c]}return a}},{key:"_getItemOffsetPx",value:function(t,e,n){var i="horizontal"===this._orientation,r=i?e.left-t.left:e.top-t.top;return-1===n&&(r+=i?e.width-t.width:e.height-t.height),r}},{key:"_getItemIndexFromPointerPosition",value:function(t,e,n,i){var r=this,o="horizontal"===this._orientation;return Y(this._itemPositions,(function(a,s,c){var l=a.drag,h=a.clientRect;if(l===t)return c.length<2;if(i){var d=o?i.x:i.y;if(l===r._previousSwap.drag&&d===r._previousSwap.delta)return!1}return o?e>=Math.floor(h.left)&&e<=Math.floor(h.right):n>=Math.floor(h.top)&&n<=Math.floor(h.bottom)}))}},{key:"_cacheItems",value:function(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}},{key:"_updateAfterScroll",value:function(t,e,n){var i=this,r=t===this._document?t.documentElement:t,o=this._parentPositions.get(t).scrollPosition,a=o.top-e,s=o.left-n;this._parentPositions.forEach((function(e,n){e.clientRect&&t!==n&&r.contains(n)&&I(e.clientRect,a,s)})),this._itemPositions.forEach((function(t){I(t.clientRect,a,s)})),this._itemPositions.forEach((function(t){var e=t.drag;i._dragDropRegistry.isDragging(e)&&e._sortFromLastPointerPosition()})),o.top=e,o.left=n}},{key:"_isOverContainer",value:function(t,e){return E(this._clientRect,t,e)}},{key:"_getSiblingContainerFromPosition",value:function(t,e,n){return this._siblings.find((function(i){return i._canReceive(t,e,n)}))}},{key:"_canReceive",value:function(t,e,n){if(!E(this._clientRect,e,n)||!this.enterPredicate(t,this))return!1;var i=this._getShadowRoot().elementFromPoint(e,n);if(!i)return!1;var r=Object(d.e)(this.element);return i===r||r.contains(i)}},{key:"_startReceiving",value:function(t){var e=this._activeSiblings;e.has(t)||(e.add(t),this._cacheParentPositions(),this._listenToScrollEvents())}},{key:"_stopReceiving",value:function(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe()}},{key:"_listenToScrollEvents",value:function(){var t=this;this._viewportScrollSubscription=this._dragDropRegistry.scroll.subscribe((function(e){if(t.isDragging()){var n=e.target;if(t._parentPositions.get(n)){var i,r;if(n===t._document){var o=t._viewportRuler.getViewportScrollPosition();i=o.top,r=o.left}else i=n.scrollTop,r=n.scrollLeft;t._updateAfterScroll(n,i,r)}}else t.isReceiving()&&t._cacheParentPositions()}))}},{key:"_getShadowRoot",value:function(){if(!this._cachedShadowRoot){var t=Object(h.c)(Object(d.e)(this.element));this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}}]),t}();function Y(t,e){for(var n=0;n<t.length;n++)if(e(t[n],n,t))return n;return-1}function N(t,e){t===window?t.scrollBy(0,e):t.scrollTop+=e}function W(t,e){t===window?t.scrollBy(e,0):t.scrollLeft+=e}function Z(t,e){var n=t.top,i=t.bottom,r=.05*t.height;return e>=n-r&&e<=n+r?1:e>=i-r&&e<=i+r?2:0}function K(t,e){var n=t.left,i=t.right,r=.05*t.width;return e>=n-r&&e<=n+r?1:e>=i-r&&e<=i+r?2:0}var V,q,U,J,Q,tt,et=Object(h.e)({passive:!1,capture:!0}),nt=((V=function(){function t(e,n){var i=this;_classCallCheck(this,t),this._ngZone=e,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=new Set,this._globalListeners=new Map,this.pointerMove=new u.a,this.pointerUp=new u.a,this.scroll=new u.a,this._preventDefaultWhileDragging=function(t){i._activeDragInstances.size&&t.preventDefault()},this._document=n}return _createClass(t,[{key:"registerDropContainer",value:function(t){this._dropInstances.has(t)||this._dropInstances.add(t)}},{key:"registerDragItem",value:function(t){var e=this;this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular((function(){e._document.addEventListener("touchmove",e._preventDefaultWhileDragging,et)}))}},{key:"removeDropContainer",value:function(t){this._dropInstances.delete(t)}},{key:"removeDragItem",value:function(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._preventDefaultWhileDragging,et)}},{key:"startDragging",value:function(t,e){var n=this;if(!this._activeDragInstances.has(t)&&(this._activeDragInstances.add(t),1===this._activeDragInstances.size)){var i=e.type.startsWith("touch"),r=i?"touchend":"mouseup";this._globalListeners.set(i?"touchmove":"mousemove",{handler:function(t){return n.pointerMove.next(t)},options:et}).set(r,{handler:function(t){return n.pointerUp.next(t)},options:!0}).set("scroll",{handler:function(t){return n.scroll.next(t)},options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:et}),this._ngZone.runOutsideAngular((function(){n._globalListeners.forEach((function(t,e){n._document.addEventListener(e,t.handler,t.options)}))}))}}},{key:"stopDragging",value:function(t){this._activeDragInstances.delete(t),0===this._activeDragInstances.size&&this._clearGlobalListeners()}},{key:"isDragging",value:function(t){return this._activeDragInstances.has(t)}},{key:"ngOnDestroy",value:function(){var t=this;this._dragInstances.forEach((function(e){return t.removeDragItem(e)})),this._dropInstances.forEach((function(e){return t.removeDropContainer(e)})),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}},{key:"_clearGlobalListeners",value:function(){var t=this;this._globalListeners.forEach((function(e,n){t._document.removeEventListener(n,e.handler,e.options)})),this._globalListeners.clear()}}]),t}()).\u0275fac=function(t){return new(t||V)(c.cc(c.z),c.cc(i.e))},V.\u0275prov=Object(c.Ob)({factory:function(){return new V(Object(c.cc)(c.z),Object(c.cc)(i.e))},token:V,providedIn:"root"}),V),it={dragStartThreshold:5,pointerDirectionChangeThreshold:5},rt=((q=function(){function t(e,n,i,r){_classCallCheck(this,t),this._document=e,this._ngZone=n,this._viewportRuler=i,this._dragDropRegistry=r}return _createClass(t,[{key:"createDrag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:it;return new T(t,e,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}},{key:"createDropList",value:function(t){return new X(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}]),t}()).\u0275fac=function(t){return new(t||q)(c.cc(i.e),c.cc(c.z),c.cc(l.g),c.cc(nt))},q.\u0275prov=Object(c.Ob)({factory:function(){return new q(Object(c.cc)(i.e),Object(c.cc)(c.z),Object(c.cc)(l.g),Object(c.cc)(nt))},token:q,providedIn:"root"}),q),ot=new c.q("CDK_DRAG_PARENT"),at=((Q=function(){function t(e,n){_classCallCheck(this,t),this.element=e,this._stateChanges=new u.a,this._disabled=!1,this._parentDrag=n,S(e.nativeElement,!1)}return _createClass(t,[{key:"ngOnDestroy",value:function(){this._stateChanges.complete()}},{key:"disabled",get:function(){return this._disabled},set:function(t){this._disabled=Object(d.c)(t),this._stateChanges.next(this)}}]),t}()).\u0275fac=function(t){return new(t||Q)(c.Sb(c.l),c.Sb(ot,8))},Q.\u0275dir=c.Nb({type:Q,selectors:[["","cdkDragHandle",""]],hostAttrs:[1,"cdk-drag-handle"],inputs:{disabled:["cdkDragHandleDisabled","disabled"]}}),Q),st=((J=function t(e){_classCallCheck(this,t),this.templateRef=e}).\u0275fac=function(t){return new(t||J)(c.Sb(c.L))},J.\u0275dir=c.Nb({type:J,selectors:[["ng-template","cdkDragPlaceholder",""]],inputs:{data:"data"}}),J),ct=((U=function(){function t(e){_classCallCheck(this,t),this.templateRef=e,this._matchSize=!1}return _createClass(t,[{key:"matchSize",get:function(){return this._matchSize},set:function(t){this._matchSize=Object(d.c)(t)}}]),t}()).\u0275fac=function(t){return new(t||U)(c.Sb(c.L))},U.\u0275dir=c.Nb({type:U,selectors:[["ng-template","cdkDragPreview",""]],inputs:{matchSize:"matchSize",data:"data"}}),U),lt=new c.q("CDK_DRAG_CONFIG"),ht=new c.q("CDK_DROP_LIST"),dt=((tt=function(){function t(e,n,i,r,o,s,l,h,d){var f=this;_classCallCheck(this,t),this.element=e,this.dropContainer=n,this._document=i,this._ngZone=r,this._viewContainerRef=o,this._dir=l,this._changeDetectorRef=d,this._destroyed=new u.a,this.started=new c.n,this.released=new c.n,this.ended=new c.n,this.entered=new c.n,this.exited=new c.n,this.dropped=new c.n,this.moved=new g.a((function(t){var e=f._dragRef.moved.pipe(Object(a.a)((function(t){return{source:f,pointerPosition:t.pointerPosition,event:t.event,delta:t.delta,distance:t.distance}}))).subscribe(t);return function(){e.unsubscribe()}})),this._dragRef=h.createDrag(e,{dragStartThreshold:s&&null!=s.dragStartThreshold?s.dragStartThreshold:5,pointerDirectionChangeThreshold:s&&null!=s.pointerDirectionChangeThreshold?s.pointerDirectionChangeThreshold:5,zIndex:null==s?void 0:s.zIndex}),this._dragRef.data=this,s&&this._assignDefaults(s),n&&(this._dragRef._withDropContainer(n._dropListRef),n.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}return _createClass(t,[{key:"getPlaceholderElement",value:function(){return this._dragRef.getPlaceholderElement()}},{key:"getRootElement",value:function(){return this._dragRef.getRootElement()}},{key:"reset",value:function(){this._dragRef.reset()}},{key:"getFreeDragPosition",value:function(){return this._dragRef.getFreeDragPosition()}},{key:"ngAfterViewInit",value:function(){var t=this;this._ngZone.onStable.asObservable().pipe(Object(D.a)(1),Object(s.a)(this._destroyed)).subscribe((function(){t._updateRootElement(),t._handles.changes.pipe(Object(m.a)(t._handles),Object(k.a)((function(e){var n=e.filter((function(e){return e._parentDrag===t})).map((function(t){return t.element}));t._dragRef.withHandles(n)})),Object(o.a)((function(t){return Object(b.a).apply(void 0,_toConsumableArray(t.map((function(t){return t._stateChanges.pipe(Object(m.a)(t))}))))})),Object(s.a)(t._destroyed)).subscribe((function(e){var n=t._dragRef,i=e.element.nativeElement;e.disabled?n.disableHandle(i):n.enableHandle(i)})),t.freeDragPosition&&t._dragRef.setFreeDragPosition(t.freeDragPosition)}))}},{key:"ngOnChanges",value:function(t){var e=t.rootElementSelector,n=t.freeDragPosition;e&&!e.firstChange&&this._updateRootElement(),n&&!n.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}},{key:"ngOnDestroy",value:function(){this.dropContainer&&this.dropContainer.removeItem(this),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()}},{key:"_updateRootElement",value:function(){var t=this.element.nativeElement,e=this.rootElementSelector?ut(t,this.rootElementSelector):t;if(e&&e.nodeType!==this._document.ELEMENT_NODE)throw Error("cdkDrag must be attached to an element node. "+'Currently attached to "'.concat(e.nodeName,'".'));this._dragRef.withRootElement(e||t)}},{key:"_getBoundaryElement",value:function(){var t=this.boundaryElement;if(!t)return null;if("string"==typeof t)return ut(this.element.nativeElement,t);var e=Object(d.e)(t);if(Object(c.W)()&&!e.contains(this.element.nativeElement))throw Error("Draggable element is not inside of the node passed into cdkDragBoundary.");return e}},{key:"_syncInputs",value:function(t){var e=this;t.beforeStarted.subscribe((function(){if(!t.isDragging()){var n=e._dir,i=e.dragStartDelay,r=e._placeholderTemplate?{template:e._placeholderTemplate.templateRef,context:e._placeholderTemplate.data,viewContainer:e._viewContainerRef}:null,o=e._previewTemplate?{template:e._previewTemplate.templateRef,context:e._previewTemplate.data,matchSize:e._previewTemplate.matchSize,viewContainer:e._viewContainerRef}:null;t.disabled=e.disabled,t.lockAxis=e.lockAxis,t.dragStartDelay="object"==typeof i&&i?i:Object(d.f)(i),t.constrainPosition=e.constrainPosition,t.previewClass=e.previewClass,t.withBoundaryElement(e._getBoundaryElement()).withPlaceholderTemplate(r).withPreviewTemplate(o),n&&t.withDirection(n.value)}}))}},{key:"_handleEvents",value:function(t){var e=this;t.started.subscribe((function(){e.started.emit({source:e}),e._changeDetectorRef.markForCheck()})),t.released.subscribe((function(){e.released.emit({source:e})})),t.ended.subscribe((function(t){e.ended.emit({source:e,distance:t.distance}),e._changeDetectorRef.markForCheck()})),t.entered.subscribe((function(t){e.entered.emit({container:t.container.data,item:e,currentIndex:t.currentIndex})})),t.exited.subscribe((function(t){e.exited.emit({container:t.container.data,item:e})})),t.dropped.subscribe((function(t){e.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,isPointerOverContainer:t.isPointerOverContainer,item:e,distance:t.distance})}))}},{key:"_assignDefaults",value:function(t){var e=t.lockAxis,n=t.dragStartDelay,i=t.constrainPosition,r=t.previewClass,o=t.boundaryElement,a=t.draggingDisabled,s=t.rootElementSelector;this.disabled=null!=a&&a,this.dragStartDelay=n||0,e&&(this.lockAxis=e),i&&(this.constrainPosition=i),r&&(this.previewClass=r),o&&(this.boundaryElement=o),s&&(this.rootElementSelector=s)}},{key:"disabled",get:function(){return this._disabled||this.dropContainer&&this.dropContainer.disabled},set:function(t){this._disabled=Object(d.c)(t),this._dragRef.disabled=this._disabled}}]),t}()).\u0275fac=function(t){return new(t||tt)(c.Sb(c.l),c.Sb(ht,12),c.Sb(i.e),c.Sb(c.z),c.Sb(c.P),c.Sb(lt,8),c.Sb(x.c,8),c.Sb(rt),c.Sb(c.h))},tt.\u0275dir=c.Nb({type:tt,selectors:[["","cdkDrag",""]],contentQueries:function(t,e,n){var i;1&t&&(c.Kb(n,ct,!0),c.Kb(n,st,!0),c.Kb(n,at,!0)),2&t&&(c.yc(i=c.hc())&&(e._previewTemplate=i.first),c.yc(i=c.hc())&&(e._placeholderTemplate=i.first),c.yc(i=c.hc())&&(e._handles=i))},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,e){2&t&&c.Jb("cdk-drag-disabled",e.disabled)("cdk-drag-dragging",e._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[c.Bb([{provide:ot,useExisting:tt}]),c.Ab]}),tt);function ut(t,e){for(var n=t.parentElement;n;){if(n.matches?n.matches(e):n.msMatchesSelector(e))return n;n=n.parentElement}return null}var ft,gt=((ft=function t(){_classCallCheck(this,t)}).\u0275mod=c.Qb({type:ft}),ft.\u0275inj=c.Pb({factory:function(t){return new(t||ft)},providers:[rt]}),ft),pt=function(t,e){return[t[0]+e[0],t[1]+e[1]]},vt=function(t,e){return[t[0]*e,t[1]*e]},yt=function(t,e){return t[0]*e[1]-t[1]*e[0]==0},_t=function(t,e){return t[0]*e[0]+t[1]*e[1]};function bt(t,e){return t.find((function(t){return t!==e}))}function mt(t){return(0!==t[0]||0!==t[1])&&(0===t[0]?[0,t[1]/Math.abs(t[1])]:0===t[1]?[t[0]/Math.abs(t[0]),0]:function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]}(t))}var Dt,kt,xt=function(t){return t.rect="rect",t.diamond="diamond",t.ellipse="ellipse",t.line="line",t}({}),wt=function(t){return t[t.top=0]="top",t[t.right=1]="right",t[t.bottom=2]="bottom",t[t.left=3]="left",t}({}),St=((Dt=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"getGraphData",value:function(t){switch(t.type){case xt.rect:var e=Object.assign({width:100,height:34,x:0,y:0},t),n=Object.assign({color:"#ccc",fontSize:12},e.style),i=e.width-2*n.radius,r=e.height-2*n.radius;return n.dx=e.width/2,n.dy=(e.height-n.fontSize)/2,e.data="M0,0m".concat(n.radius+1,",1h").concat(i,"a").concat(n.radius,",\n              ").concat(n.radius,",0,0,1,").concat(n.radius,",").concat(n.radius,"v").concat(r,"a\n              ").concat(n.radius,",").concat(n.radius,",0,0,1,-").concat(n.radius,",\n              ").concat(n.radius,"h-").concat(i,"a").concat(n.radius,",").concat(n.radius,",0,0,1,-\n              ").concat(n.radius,",-").concat(n.radius,"v-").concat(r,"a").concat(n.radius,",\n              ").concat(n.radius,",0,0,1,").concat(n.radius,",-").concat(n.radius,"z").replace(/\s/g,""),Object.assign(Object.assign({},e),{style:n});case xt.diamond:var o=Object.assign({width:100,height:34,x:0,y:0},t),a=Object.assign({color:"#ccc",fontSize:12},o.style),s=o.width/2,c=parseInt(Math.sqrt(s*s/3).toFixed(2),0);return a.dx=s+1,a.dy=c-6,o.height=2*c,o.data="M".concat(s+1,",1m-4,1.53a6,6,0,0,1,8,0\n              l").concat(s-5.53,",").concat(c-3.53,"a6,3,0,0,1,0,4l").concat(5.53-s,",").concat(c-3.53,"\n              a6,6,0,0,1,-8,0l").concat(5.53-s,",").concat(3.53-c,"a6,3,0,0,1,0,-4z").replace(/\s/g,""),Object.assign(Object.assign({},o),{style:a});case xt.ellipse:var l=Object.assign({width:100,height:34,x:0,y:0},t),h=Object.assign({color:"#ccc",fontSize:12},l.style);h.dx=l.width/2;var d=l.height/2;return h.dy=(l.height-h.fontSize)/2,l.data="M0,0m".concat(d,",").concat(l.height,"a").concat(d,",").concat(d,",0,0,1,0,-").concat(l.height,"l\n        ").concat(l.width-l.height,",0a").concat(d,",").concat(d,",0,0,1,0,").concat(l.height,"z").replace(/\s/g,""),Object.assign(Object.assign({},l),{style:h});case xt.line:return this.drawLine(t)}}},{key:"getDiamondHeight",value:function(t){var e=t/2;return 2*parseInt(Math.sqrt(e*e/3).toFixed(2),0)}},{key:"drawLine",value:function(t){var e=Object.assign({},t),n=Object.assign({color:"#aaa"},e.style),i=function(t){var e,n,i=t.entryPoint,r=void 0===i?[0,0]:i,o=t.entryDirection,a=void 0===o?[0,1]:o,s=t.entryExt,c=void 0===s?10:s,l=t.exitPoint,h=void 0===l?[10,10]:l,d=t.exitDirection,u=void 0===d?[1,0]:d,f=t.exitExt,g=void 0===f?10:f,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(null===u||"0,0"===u.join()){var v=[(n=r)[0]-(e=h)[0],n[1]-e[1]];u=Math.abs(v[0])>Math.abs(v[1])?[v[0]/Math.abs(v[0]),0]:[0,v[1]/Math.abs(v[1])]}var y=pt(r,vt(a,c)),_=pt(h,vt(u,g));u=vt(u,-1);var b,m,D=[[_[0]-y[0],0],[0,_[1]-y[1]]],k=D.find((function(t){return yt(t,a)}));b=_t(k,a)>0?k:bt(D,k);var x=D.find((function(t){return yt(t,u)}));m=_t(x,u)>0?x:bt(D,x);var w=_t(b,m)>0?2:1,S=bt(D,m),z=[];if(z.push({position:r,direction:null},{position:y,direction:a}),1===w){var P=pt(y,b),C=mt(b),E=pt(P,m),I=mt(m);z.push({position:P,direction:C},{position:E,direction:I})}else{var R=pt(y,vt(b,p)),O=mt(b),G=pt(R,S),T=mt(S),M=pt(G,vt(m,1-p)),L=mt(m);z.push({position:R,direction:O},{position:G,direction:T,type:"pathMiddleP"},{position:M,direction:L})}return z.push({position:h,direction:u}),z.filter((function(t){return!1!==t.direction}))}({entryPoint:[e.x1,e.y1],entryDirection:this.convertDirToVector(e.dir1),entryExt:10,exitPoint:[e.x2,e.y2],exitDirection:this.convertDirToVector(e.dir2),exitExt:10}).map((function(t){return"L".concat(t.position.toString())})),r=(Math.ceil(i.length/2),this.getLabelCenterPosition(e));return e.data=i.toString().replace(/^L/,"M").replace(/,L/g,"L"),Object.assign(Object.assign(Object.assign({},e),{style:n}),r)}},{key:"getLabelCenterPosition",value:function(t){return{x:(t.x1-t.x2)/2+t.x2+3,y:(t.y1-t.y2)/2+t.y2-3}}},{key:"getPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=(t instanceof dt?t.element.nativeElement:t).style.transform.replace(/,\s/g,",").split(" ");n=n.map((function(t){return t.replace(/.+\((-?\d+)px,(-?\d+).+/,"$1,$2")}));var i={x:0,y:0};return n.forEach((function(t){if(t){var e=t.replace(/\s/g,"").split(",");i.x+=parseInt(e[0],0),i.y+=parseInt(e[1],0)}})),{x:i.x+e.x,y:i.y+e.y}}},{key:"getDirection",value:function(t,e){var n=e.x-t.x,i=e.y-t.y,r=n>0?wt.right:wt.left,o=i>0?wt.bottom:wt.top;return Math.abs(n)>Math.abs(i)?r:o}},{key:"convertDirToVector",value:function(t){return[[0,-1],[1,0],[0,1],[-1,0]][t]}},{key:"getGraphPoints",value:function(t){var e=t.x,n=t.y,i=t.width,r=t.height;return{top:this.offsetPoint({x:e,y:n},{x:i/2+1,y:1}),right:this.offsetPoint({x:e,y:n},{x:i+1,y:r/2+1}),bottom:this.offsetPoint({x:e,y:n},{x:i/2+1,y:r+1}),left:this.offsetPoint({x:e,y:n},{x:1,y:r/2+1})}}},{key:"offsetPoint",value:function(t,e){return{x:t.x+e.x,y:t.y+e.y}}}]),t}()).\u0275fac=function(t){return new(t||Dt)},Dt.\u0275prov=c.Ob({token:Dt,factory:Dt.\u0275fac}),Dt),zt=n("2Vo4"),Pt=n("Kj3r"),Ct=function(){function t(){_classCallCheck(this,t),this.graphs=[]}return _createClass(t,[{key:"find",value:function(t){var e="object"==typeof t?t.id:t;return this.graphs.find((function(t){return t.id===e}))}},{key:"findIndex",value:function(t){var e="object"==typeof t?t.id:t;return this.graphs.findIndex((function(t){return t.id===e}))}},{key:"clear",value:function(){this.graphs=[]}},{key:"getAll",value:function(){return this.graphs}},{key:"findGraph",value:function(t){var e,n=_createForOfIteratorHelper(this.graphs);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=this._handleGraphPoints(i);if(t.x>r.x1&&t.x<r.x2&&t.y>r.y1&&t.y<r.y2)return i}}catch(o){n.e(o)}finally{n.f()}}},{key:"_handleGraphPoints",value:function(t){var e,n=t.x1||t.x,i=t.x2||t.x+t.width;e=n,n>i&&(n=i,i=e);var r=t.y1||t.y,o=t.y2||t.y+t.height;return e=r,r>o&&(r=o,o=e),{x1:n,x2:i,y1:r,y2:o}}},{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.graphs.length;this.graphs.splice(e,0,t)}},{key:"get",value:function(t){return this.graphs[t]}},{key:"remove",value:function(t){this.graphs.splice(t,1)}},{key:"delete",value:function(t){var e="object"==typeof t?t.id:t,n=this.graphs.findIndex((function(t){return t.id===e}));this.graphs.splice(n,1)}},{key:"set",value:function(t,e){this.graphs[t]=Object.assign(Object.assign({},this.graphs[t]),e)}},{key:"length",get:function(){return this.graphs.length}}]),t}(),Et=((kt=function(){function t(e){_classCallCheck(this,t),this.fGraph=e,this.storeGraphs=new Ct,this.storeLines=new Ct,this.graphPoints=[],this.relations=[],this.storeGraphs$=new zt.a(null),this.storeLines$=new zt.a(null),this.graphs$=this.storeGraphs$.pipe(Object(Pt.a)(10)),this.lines$=this.storeLines$.pipe(Object(Pt.a)(10))}return _createClass(t,[{key:"add",value:function(t){var e;t.id="fc_"+(new Date).getTime().toString();var n=this.fGraph.getGraphData(t);return n.type===xt.line?(this.storeLines.add(n),this.storeLines$.next(this.storeLines.getAll()),n):(this.storeGraphs.add(n),(e=this.graphPoints).push.apply(e,_toConsumableArray(Object.values(this.fGraph.getGraphPoints(n)))),this.storeGraphs$.next(this.storeGraphs.getAll()),n)}},{key:"update",value:function(t){var e=this.findIndex(t.id,t.type);this.set(e,t)}},{key:"set",value:function(t,e){if(e.type===xt.line)this.storeLines.set(t,e),this.storeLines$.next(this.storeLines.getAll());else{var n;this.storeGraphs.set(t,e);var i=this.storeGraphs.get(t),r=Object.values(this.fGraph.getGraphPoints(i));(n=this.graphPoints).splice.apply(n,[t*r.length,r.length].concat(_toConsumableArray(r))),this.storeGraphs$.next(this.storeGraphs.getAll())}}},{key:"getAllLines",value:function(){return this.storeLines.getAll()}},{key:"getAllGraphs",value:function(){return this.storeGraphs.getAll()}},{key:"clear",value:function(){this.relations=[],this.graphPoints=[],this.storeGraphs.clear(),this.storeGraphs$.next([]),this.storeLines.clear(),this.storeLines$.next([])}},{key:"addRelation",value:function(t){this.relations.push(t)}},{key:"getRelations",value:function(t){return this.relations.filter(t)}},{key:"findGraphByPoint",value:function(t){return this.storeGraphs.findGraph(t)||this.storeLines.findGraph(t)}},{key:"findRelationIndex",value:function(t){return this.relations.findIndex(t)}},{key:"removeRelation",value:function(t){return this.relations.splice(t,1)}},{key:"getPoint",value:function(t){return this.graphPoints[t]}},{key:"delete",value:function(t){t.type===xt.line?(this.storeLines.delete(t),this.storeLines$.next(this.storeLines.getAll())):(this.storeGraphs.delete(t),this.storeGraphs$.next(this.storeGraphs.getAll())),this.deleteRelation(t)}},{key:"deleteRelation",value:function(t){var e=this;t.type===xt.line?this.relations.filter((function(e){return e.lineId===t.id})).forEach((function(t){var n=e.relations.findIndex((function(e){return e.lineId===t.lineId}));e.relations.splice(n,1)})):this.relations.filter((function(e){return e.graphId===t.id})).forEach((function(t){var n=e.relations.findIndex((function(e){return e.graphId===t.graphId}));e.relations.splice(n,1)}))}},{key:"findPoint",value:function(t){for(var e=this.graphPoints.length,n=0;n<e;n++){var i=this.graphPoints[n];if(i.x-10<t.x&&i.x+10>t.x&&i.y-10<t.y&&i.y+10>t.y){var r=(n+1)%4;return{graph:this.storeGraphs.get((n+1+(r>0?4-r:0))/4-1),dir:n%4,pointIndex:n,point:i}}}return null}},{key:"addAll",value:function(t){var e=this;t.forEach((function(t){var n;t.id=(new Date).getTime();var i=e.fGraph.getGraphData(t);i.type===xt.line?(e.storeLines.add(i),e.storeLines$.next(e.storeLines.getAll())):(e.storeGraphs.add(i),(n=e.graphPoints).push.apply(n,_toConsumableArray(Object.values(e.fGraph.getGraphPoints(i)))),e.storeGraphs$.next(e.storeGraphs.getAll()))}))}},{key:"addAllLines",value:function(t){var e=this;t.forEach((function(t){e.storeLines.add(e.fGraph.getGraphData(t))})),this.storeLines$.next(this.storeLines.getAll())}},{key:"addAllGraphs",value:function(t){var e=this;t.forEach((function(t){var n;e.storeGraphs.add(e.fGraph.getGraphData(t)),(n=e.graphPoints).push.apply(n,_toConsumableArray(Object.values(e.fGraph.getGraphPoints(t))))})),this.storeGraphs$.next(this.storeGraphs.getAll())}},{key:"find",value:function(t,e){var n="object"==typeof t?t:{id:t,type:e};return n.type===xt.line?this.storeLines.find(n.id):this.storeGraphs.find(n.id)}},{key:"findIndex",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt.line;return e===xt.line?this.storeLines.findIndex(t):this.storeGraphs.findIndex(t)}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xt.line;return e===xt.line?this.storeLines.get(t):this.storeGraphs.get(t)}},{key:"removeGraph",value:function(t){this.storeGraphs.remove(t)}}]),t}()).\u0275fac=function(t){return new(t||kt)(c.cc(St))},kt.\u0275prov=c.Ob({token:kt,factory:kt.\u0275fac}),kt),It=["nzo-line",""],Rt=function(t){return{transform:t}};function Ot(t,e){if(1&t){var n=c.Zb();c.jc(),c.Yb(0,"g"),c.Yb(1,"circle",4),c.gc("cdkDragStarted",(function(t){return c.Bc(n),c.kc().onDragLineStarted(t,"start")}))("cdkDragEnded",(function(t){return c.Bc(n),c.kc().onDragEndedLine(t,"start")}))("cdkDragMoved",(function(t){return c.Bc(n),c.kc().onDragLineMoved(t,"start")})),c.Xb(),c.Yb(2,"circle",4),c.gc("cdkDragStarted",(function(t){return c.Bc(n),c.kc().onDragLineStarted(t,"end")}))("cdkDragEnded",(function(t){return c.Bc(n),c.kc().onDragEndedLine(t,"end")}))("cdkDragMoved",(function(t){return c.Bc(n),c.kc().onDragLineMoved(t,"end")})),c.Xb(),c.Xb()}if(2&t){var i=c.kc();c.Cb(1),c.Jb("nzo-fc-connect-point",!i.nzoSelected),c.sc("ngStyle",c.vc(8,Rt,"translate3d("+i.nzoData.x1+"px, "+i.nzoData.y1+"px, 0)")),c.Db("transform","translate("+i.nzoData.x1+","+i.nzoData.y1+")"),c.Cb(1),c.Jb("nzo-fc-connect-point",!i.nzoSelected),c.sc("ngStyle",c.vc(10,Rt,"translate3d("+i.nzoData.x2+"px, "+i.nzoData.y2+"px, 0)")),c.Db("transform","translate("+i.nzoData.x2+","+i.nzoData.y2+")")}}var Gt,Tt,Mt=((Gt=function(){function t(e){_classCallCheck(this,t),this.fGraph=e,this.dragDisabled=!1,this.pointStart=new c.n,this.pointEnd=new c.n,this.dblclick=new c.n,this.click=new c.n,this.mousedown=new c.n,this.nzoSelected=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"onDragLineStarted",value:function(t,e){this.pointStart.emit(Object.assign(Object.assign({},t),{linePos:e}))}},{key:"onDragEndedLine",value:function(t,e){this.pointEnd.emit(Object.assign(Object.assign({},t),{linePos:e}))}},{key:"onDragLineMoved",value:function(t,e){var n=this.fGraph.getPosition(t.source),i=n.x,r=n.y;if("start"===e){var o=this.fGraph.drawLine(Object.assign(Object.assign({},this.nzoData),{x1:i,y1:r}));this.nzoData.x1=o.x1,this.nzoData.y1=o.y1,this.nzoData.data=o.data}else{var a=this.fGraph.drawLine(Object.assign(Object.assign({},this.nzoData),{x2:i,y2:r}));this.nzoData.x2=a.x2,this.nzoData.y2=a.y2,this.nzoData.data=a.data}}}]),t}()).\u0275fac=function(t){return new(t||Gt)(c.Sb(St))},Gt.\u0275cmp=c.Mb({type:Gt,selectors:[["","nzo-line",""]],inputs:{nzoData:"nzoData",dragDisabled:["nzoDragDisabled","dragDisabled"],relation:["nzoSelectedRelation","relation"],nzoSelected:"nzoSelected"},outputs:{pointStart:"nzoDragPointStarted",pointEnd:"nzoDragPointEnded",dblclick:"nzoDblclick",click:"nzoClick",mousedown:"nzoMousedown"},attrs:It,decls:4,vars:6,consts:[[1,"nzo-fc-line"],["fill","transparent","stroke-width","1","marker-end","url(#markerArrow)",3,"click","mousedown","dblclick"],["fill","rgba(0, 0, 0, 0.65)","fontSize","12",3,"innerHTML"],[4,"ngIf"],["cdkDrag","","r","3.5","stroke","#1590ff","stroke-width","1","fill","#fff",3,"ngStyle","cdkDragStarted","cdkDragEnded","cdkDragMoved"]],template:function(t,e){1&t&&(c.jc(),c.Yb(0,"g",0),c.Yb(1,"path",1),c.gc("click",(function(t){return e.click.emit(t)}))("mousedown",(function(t){return e.mousedown.emit(t)}))("dblclick",(function(t){return e.dblclick.emit(t)})),c.Xb(),c.Tb(2,"text",2),c.Kc(3,Ot,3,12,"g",3),c.Xb()),2&t&&(c.Cb(1),c.Db("stroke",e.nzoSelected?"#455FF7":"#aaa")("d",e.nzoData.data),c.Cb(1),c.sc("innerHTML",e.nzoData.text,c.Cc),c.Db("x",e.nzoData.x)("y",e.nzoData.y),c.Cb(1),c.sc("ngIf",!e.dragDisabled&&(null==e.relation?null:e.relation.lineId)!==e.nzoData.id))},directives:[i.t,dt,i.w],encapsulation:2}),Gt),Lt=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"isHex",value:function(t){return/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(t)}},{key:"isRgbOrRgba",value:function(t){return/^rgb/.test(t)}},{key:"hex2Rgba",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t.toLowerCase();if(n&&this.isHex(n)){if(4===n.length){for(var i="#",r=1;r<4;r+=1)i+=n.slice(r,r+1).concat(n.slice(r,r+1));n=i}for(var o=[],a=1;a<7;a+=2)o.push(parseInt("0x"+n.slice(a,a+2),0));return"rgba("+o.join(",")+","+(e||1)+")"}return n}},{key:"gradientColor",value:function(t,e,n){if(n>=1)return t;if((this.isHex(t)||this.isRgbOrRgba(t))&&(this.isHex(e)||this.isRgbOrRgba(e))){var i=this.hex2Rgba(t).replace(/^rgba?\(([\,\s\d]+)\)$/,"$1").split(","),r=this.hex2Rgba(e).replace(/^rgba?\(([\,\s\d]+)\)$/,"$1").split(","),o=(parseInt(r[0],0)-parseInt(i[0],0))*(1-n)+parseInt(i[0],0),a=(parseInt(r[1],0)-parseInt(i[1],0))*(1-n)+parseInt(i[1],0),s=(parseInt(r[2],0)-parseInt(i[2],0))*(1-n)+parseInt(i[2],0);return"rgb(".concat(Math.floor(o),",").concat(Math.floor(a),",").concat(Math.floor(s),")")}return t}}]),t}(),jt=["nzo-graph",""],At=function(t){return{transform:t}},Bt=function(t){return{fontSize:t}},Ft=((Tt=function(){function t(){_classCallCheck(this,t),this.nzoBorder=1,this.nzoSelected=!1,this.nzoPoint=!1,this.dragDisabled=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"gradient",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return Lt.gradientColor(t,"#fff",e)}}]),t}()).\u0275fac=function(t){return new(t||Tt)},Tt.\u0275cmp=c.Mb({type:Tt,selectors:[["","nzo-graph",""]],inputs:{nzoData:"nzoData",nzoBorder:"nzoBorder",nzoSelected:"nzoSelected",nzoPoint:"nzoPoint",dragDisabled:["nzoDragDisabled","dragDisabled"]},attrs:jt,decls:3,vars:15,consts:[[1,"nzo-fc-rect-box",3,"ngStyle"],["text-rendering","inherit","text-anchor","middle","dominant-baseline","text-before-edge",1,"iconfont",3,"ngStyle","innerHTML"]],template:function(t,e){1&t&&(c.jc(),c.Yb(0,"g",0),c.Tb(1,"path"),c.Tb(2,"text",1),c.Xb()),2&t&&(c.sc("ngStyle",c.vc(11,At,"translate3d("+e.nzoData.x+"px, "+e.nzoData.y+"px, 0)")),c.Db("transform","translate("+e.nzoData.x+","+e.nzoData.y+")"),c.Cb(1),c.Db("fill",e.gradient(e.nzoData.style.color,e.nzoSelected?1:.1))("stroke-width",e.nzoBorder)("stroke",e.nzoData.style.color)("d",e.nzoData.data),c.Cb(1),c.sc("ngStyle",c.vc(13,Bt,e.nzoData.style.fontSize+"px"))("innerHTML",e.nzoData.text,c.Cc),c.Db("fill",e.nzoSelected?"#fff":e.nzoData.style.color)("transform","translate("+e.nzoData.style.dx+","+e.nzoData.style.dy+")")("font-size",e.nzoData.style.fontSize))},directives:[i.w],encapsulation:2}),Tt),$t=["nzo-graph-shadow",""],Ht=function(t){return{transform:t}};function Xt(t,e){if(1&t){var n=c.Zb();c.jc(),c.Yb(0,"circle",4),c.gc("cdkDragStarted",(function(t){c.Bc(n);var e=c.kc(2);return e.onDragStart(t,{x:e.nzoData.width/2+1,y:1,direction:0})}))("cdkDragEnded",(function(t){return c.Bc(n),c.kc(2).onDragEnd(t)}))("cdkDragMoved",(function(t){return c.Bc(n),c.kc(2).onDragMoved(t)}))("mousedown",(function(t){return c.Bc(n),c.kc(2).preventEvent(t)})),c.Xb()}if(2&t){var i=c.kc(2);c.Jb("nzo-fc-connect-point",!i.nzoSelected),c.sc("ngStyle",c.vc(4,Ht,"translate3d("+(i.nzoData.width/2+1)+"px, 1px, 0)")),c.Db("transform","translate("+(i.nzoData.width/2+1)+",1)")}}function Yt(t,e){if(1&t){var n=c.Zb();c.jc(),c.Yb(0,"circle",4),c.gc("cdkDragStarted",(function(t){c.Bc(n);var e=c.kc(2);return e.onDragStart(t,{x:e.nzoData.width/2+1,y:e.nzoData.height+1,direction:2})}))("cdkDragEnded",(function(t){return c.Bc(n),c.kc(2).onDragEnd(t)}))("cdkDragMoved",(function(t){return c.Bc(n),c.kc(2).onDragMoved(t)}))("mousedown",(function(t){return c.Bc(n),c.kc(2).preventEvent(t)})),c.Xb()}if(2&t){var i=c.kc(2);c.Jb("nzo-fc-connect-point",!i.nzoSelected),c.sc("ngStyle",c.vc(4,Ht,"translate3d("+(i.nzoData.width/2+1)+"px, "+(i.nzoData.height+1)+"px, 0)")),c.Db("transform","translate("+(i.nzoData.width/2+1)+","+(i.nzoData.height+1)+")")}}function Nt(t,e){if(1&t){var n=c.Zb();c.jc(),c.Yb(0,"circle",4),c.gc("cdkDragStarted",(function(t){c.Bc(n);var e=c.kc(2);return e.onDragStart(t,{x:1,y:e.nzoData.height/2+1,direction:3})}))("cdkDragEnded",(function(t){return c.Bc(n),c.kc(2).onDragEnd(t)}))("cdkDragMoved",(function(t){return c.Bc(n),c.kc(2).onDragMoved(t)}))("mousedown",(function(t){return c.Bc(n),c.kc(2).preventEvent(t)})),c.Xb()}if(2&t){var i=c.kc(2);c.Jb("nzo-fc-connect-point",!i.nzoSelected),c.sc("ngStyle",c.vc(4,Ht,"translate3d(1px, "+(i.nzoData.height/2+1)+"px, 0)")),c.Db("transform","translate(1,"+(i.nzoData.height/2+1)+")")}}function Wt(t,e){if(1&t){var n=c.Zb();c.jc(),c.Yb(0,"circle",4),c.gc("cdkDragStarted",(function(t){c.Bc(n);var e=c.kc(2);return e.onDragStart(t,{x:e.nzoData.width+1,y:e.nzoData.height/2+1,direction:1})}))("cdkDragEnded",(function(t){return c.Bc(n),c.kc(2).onDragEnd(t)}))("cdkDragMoved",(function(t){return c.Bc(n),c.kc(2).onDragMoved(t)}))("mousedown",(function(t){return c.Bc(n),c.kc(2).preventEvent(t)})),c.Xb()}if(2&t){var i=c.kc(2);c.Jb("nzo-fc-connect-point",!i.nzoSelected),c.sc("ngStyle",c.vc(4,Ht,"translate3d("+(i.nzoData.width+1)+"px, "+(i.nzoData.height/2+1)+"px, 0)")),c.Db("transform","translate("+(i.nzoData.width+1)+","+(i.nzoData.height/2+1)+")")}}function Zt(t,e){if(1&t&&(c.jc(),c.Yb(0,"g"),c.Kc(1,Xt,1,6,"circle",3),c.Kc(2,Yt,1,6,"circle",3),c.Kc(3,Nt,1,6,"circle",3),c.Kc(4,Wt,1,6,"circle",3),c.Xb()),2&t){var n=c.kc();c.Cb(1),c.sc("ngIf",!n.isMoving),c.Cb(1),c.sc("ngIf",!n.isMoving),c.Cb(1),c.sc("ngIf",!n.isMoving),c.Cb(1),c.sc("ngIf",!n.isMoving)}}var Kt,Vt,qt=((Vt=function(){function t(){_classCallCheck(this,t),this.nzoBorder=1,this.nzoSelected=!1,this.nzoPoint=!1,this.click=new c.n,this.dblclick=new c.n,this.started=new c.n,this.ended=new c.n,this.pointStarted=new c.n,this.pointMoved=new c.n,this.pointEnded=new c.n,this.isMoving=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"opacity",value:function(t){return Lt.hex2Rgba(t,.1)}},{key:"onMoveDragStart",value:function(t){this.isMoving=!0,this.started.emit(t)}},{key:"onMoveDragEnd",value:function(t){this.isMoving=!1,this.ended.emit(t)}},{key:"preventEvent",value:function(t){t.stopPropagation(),t.preventDefault()}},{key:"onDragStart",value:function(t,e){this.pointStarted.emit(Object.assign(Object.assign({},t),{data:e}))}},{key:"onDragMoved",value:function(t){this.pointMoved.emit(t)}},{key:"onDragEnd",value:function(t){this.pointEnded.emit(t),t.source.reset()}}]),t}()).\u0275fac=function(t){return new(t||Vt)},Vt.\u0275cmp=c.Mb({type:Vt,selectors:[["","nzo-graph-shadow",""]],inputs:{nzoData:"nzoData",nzoBorder:"nzoBorder",nzoSelected:"nzoSelected",nzoPoint:"nzoPoint",relation:["nzoSelectedRelation","relation"]},outputs:{click:"nzoClick",dblclick:"nzoDblclick",started:"nzoDragGraphStarted",ended:"nzoDragGraphEnded",pointStarted:"nzoDragPointStarted",pointMoved:"nzoDragPointMoved",pointEnded:"nzoDragPointEnded"},attrs:$t,decls:3,vars:9,consts:[["cdkDrag","",1,"nzo-fc-rect-box","nzo-fc-drag",3,"ngStyle","cdkDragStarted","dblclick","click","cdkDragEnded"],["stroke-dasharray","5,5"],[4,"ngIf"],["cdkDrag","","r","3.5","stroke","#1590ff","stroke-width","1","fill","#fff",3,"nzo-fc-connect-point","ngStyle","cdkDragStarted","cdkDragEnded","cdkDragMoved","mousedown",4,"ngIf"],["cdkDrag","","r","3.5","stroke","#1590ff","stroke-width","1","fill","#fff",3,"ngStyle","cdkDragStarted","cdkDragEnded","cdkDragMoved","mousedown"]],template:function(t,e){1&t&&(c.jc(),c.Yb(0,"g",0),c.gc("cdkDragStarted",(function(t){return e.onMoveDragStart(t)}))("dblclick",(function(t){return e.dblclick.emit(t)}))("click",(function(t){return e.click.emit(t)}))("cdkDragEnded",(function(t){return e.onMoveDragEnd(t)})),c.Tb(1,"path",1),c.Kc(2,Zt,5,4,"g",2),c.Xb()),2&t&&(c.sc("ngStyle",c.vc(7,Ht,"translate3d("+e.nzoData.x+"px, "+e.nzoData.y+"px, 0)")),c.Db("transform","translate("+e.nzoData.x+","+e.nzoData.y+")"),c.Cb(1),c.Db("fill",e.isMoving?e.opacity(e.nzoData.style.color):"transparent")("stroke-width",e.nzoBorder)("stroke",e.isMoving?e.nzoData.style.color:"transparent")("d",e.nzoData.data),c.Cb(1),c.sc("ngIf",e.nzoPoint&&(null==e.relation?null:e.relation.graphId)!==e.nzoData.id))},directives:[dt,i.w,i.t],encapsulation:2}),Vt),Ut=((Kt=function(){function t(e){_classCallCheck(this,t),this.elemRef=e,this.copy=new c.n,this.paste=new c.n,this.delete=new c.n}return _createClass(t,[{key:"ngOnInit",value:function(){this.elemRef.nativeElement.style.position="fixed",this.hidden()}},{key:"ngOnChanges",value:function(t){var e=this;t.pos&&this.pos&&this.setPosition().then((function(){e.show()}))}},{key:"setPosition",value:function(){var t=this;return this.hidden(),Promise.resolve().then((function(){var e=t.elemRef.nativeElement;e.style.left=t.pos.x+"px",e.style.top=t.pos.y+"px"}))}},{key:"onClose",value:function(t){var e=this;if(2!==t.button)var n=setTimeout((function(){e.hidden(),clearTimeout(n)}),150)}},{key:"ngOnDestroy",value:function(){}},{key:"show",value:function(){this.elemRef.nativeElement.style.display="block"}},{key:"hidden",value:function(){this.elemRef.nativeElement.style.display="none"}},{key:"onEvent",value:function(t,e){t.stopPropagation(),e.emit(t)}}]),t}()).\u0275fac=function(t){return new(t||Kt)(c.Sb(c.l))},Kt.\u0275cmp=c.Mb({type:Kt,selectors:[["nzo-contextmenu"]],hostBindings:function(t,e){1&t&&c.gc("mousedown",(function(t){return e.onClose(t)}),!1,c.Ac)},inputs:{pos:["nzoPosition","pos"]},outputs:{copy:"nzoCopy",paste:"nzoPaste",delete:"nzoDelete"},features:[c.Ab],decls:4,vars:0,consts:[[1,"ant-dropdown-menu","ant-dropdown-menu-root","ant-dropdown-menu-light","ant-dropdown-menu-vertical"],[1,"ant-dropdown-menu-item",3,"click"],["nz-icon","","nzType","delete"]],template:function(t,e){1&t&&(c.Yb(0,"ul",0),c.Yb(1,"li",1),c.gc("click",(function(t){return e.onEvent(t,e.delete)})),c.Tb(2,"i",2),c.Mc(3,"\u5220 \u9664"),c.Xb(),c.Xb())},styles:["ul[_ngcontent-%COMP%], li[_ngcontent-%COMP%] {\n        list-style: none;\n      }"]}),Kt),Jt=["rootCvs"];function Qt(t,e){1&t&&c.Ub(0)}function te(t,e){1&t&&(c.jc(),c.Tb(0,"g",16)),2&t&&c.sc("nzoData",e.$implicit)}function ee(t,e){if(1&t){var n=c.Zb();c.jc(),c.Yb(0,"g",17),c.gc("nzoDragGraphStarted",(function(t){c.Bc(n);var i=e.$implicit,r=e.index;return c.kc(2).onCopyGraphDragStart(t,i,r)}))("nzoDragGraphEnded",(function(t){return c.Bc(n),c.kc(2).onCopyGraphDragEnd(t,{x:0,y:16})})),c.Xb()}2&t&&c.sc("nzoData",e.$implicit)}function ne(t,e){if(1&t&&(c.jc(),c.Yb(0,"g",13),c.Kc(1,te,1,1,"g",14),c.Kc(2,ee,1,1,"g",15),c.Xb()),2&t){var n=c.kc();c.Cb(1),c.sc("ngForOf",n.modalGraphs),c.Cb(1),c.sc("ngForOf",n.modalGraphs)}}function ie(t,e){if(1&t&&(c.jc(),c.Tb(0,"line",18)),2&t){var n=c.kc();c.Db("x1",n.sideWidth)("x2",n.sideWidth)}}function re(t,e){if(1&t&&(c.jc(),c.Tb(0,"g",19)),2&t){var n=e.$implicit,i=e.index,r=c.kc();c.sc("nzoData",n)("nzoPoint",!0)("nzoDragDisabled",!r.isEditMode)("nzoSelected",r.selectedGraph===i)}}function oe(t,e){if(1&t){var n=c.Zb();c.jc(),c.Yb(0,"g",20),c.gc("nzoDblclick",(function(t){return c.Bc(n),c.kc().onAddLabel(t)}))("nzoMousedown",(function(t){c.Bc(n);var i=e.$implicit;return c.kc().onContextLine(t,i)}))("nzoClick",(function(t){c.Bc(n);var i=e.$implicit,r=e.index;return c.kc().onSelectedLine(t,i,r)}))("nzoDragPointStarted",(function(t){c.Bc(n);var i=e.$implicit;return c.kc().onDragLinePointStart(t,i)}))("nzoDragPointEnded",(function(t){c.Bc(n);var i=e.$implicit,r=e.index;return c.kc().onDragLinePointEnd(t,i,r)})),c.Xb()}if(2&t){var i=e.$implicit,r=e.index,o=c.kc();c.sc("nzoData",i)("nzoDragDisabled",!o.isEditMode)("nzoSelected",o.selectedLine===r)}}function ae(t,e){if(1&t){var n=c.Zb();c.jc(),c.Yb(0,"g",22),c.gc("nzoClick",(function(t){c.Bc(n);var i=e.index;return c.kc(2).onSelectedGraph(t,i)}))("nzoDblclick",(function(){c.Bc(n);var t=e.$implicit;return c.kc(2).dblclickGraph.emit(t)}))("nzoDragGraphStarted",(function(t){c.Bc(n);var i=e.$implicit,r=e.index;return c.kc(2).onDragGraphStart(t,i,r)}))("nzoDragGraphEnded",(function(t){c.Bc(n);var i=e.$implicit;return c.kc(2).onDragGraphEnd(t,i)}))("nzoDragPointStarted",(function(t){return c.Bc(n),c.kc(2).onDragGraphPointStart(t)}))("nzoDragPointMoved",(function(t){return c.Bc(n),c.kc(2).onDragGraphPointMove(t)}))("nzoDragPointEnded",(function(t){return c.Bc(n),c.kc(2).onDragGraphPointEnd(t)})),c.Xb()}if(2&t){var i=e.$implicit,r=e.index,o=c.kc(2);c.sc("nzoData",i)("nzoPoint",!0)("nzoSelected",o.selectedGraph===r)("nzoSelectedRelation",o.getRelationByGraph(o.selectedRelations,i))}}function se(t,e){if(1&t&&(c.jc(),c.Wb(0),c.Kc(1,ae,1,4,"g",21),c.lc(2,"async"),c.Vb()),2&t){var n=c.kc();c.Cb(1),c.sc("ngForOf",c.mc(2,1,n.flow.graphs$))}}function ce(t,e){if(1&t){var n=c.Zb();c.jc(),c.ic(),c.Yb(0,"nzo-contextmenu",23),c.gc("nzoDelete",(function(){return c.Bc(n),c.kc().onMenuDelete()}))("nzoCopy",(function(){return c.Bc(n),c.kc().onMenuCopy()}))("nzoPaste",(function(){return c.Bc(n),c.kc().onMenuPaste()})),c.Xb()}if(2&t){var i=c.kc();c.sc("nzoPosition",i.contextPosition)}}var le,he,de,ue,fe,ge,pe=((le=function(){function t(e,n){_classCallCheck(this,t),this.fcStore=e,this.fGraph=n,this.radius=3,this.borderWidth=1,this.fontSize=12,this.sideWidth=110,this.isEditMode=!0,this.flowChange=new c.n,this.dblclickGraph=new c.n,this.dblclickLine=new c.n,this.contextMenu=new c.n,this.appendGraph=new c.n,this.changeRelation=new c.n,this.canCopy=!1,this.modalGraphs=this.handleData([{type:xt.ellipse,text:"\u5f00\u59cb",width:68,height:30,x:20,y:0,style:{color:"#1590ff"}},{type:xt.rect,text:"\u6761\u4ef6",width:68,height:30,style:{color:"#b786ec"},x:20,y:50},{type:xt.diamond,text:"\u5224\u65ad",width:68,style:{color:"#65ddd5"},x:20,y:100}])}return _createClass(t,[{key:"ngOnChanges",value:function(t){this.flow={graphs$:this.fcStore.graphs$,lines$:this.fcStore.lines$}}},{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.fcStore.clear()}},{key:"handleData",value:function(t){var e=this;return t.map((function(t){return e.fGraph.getGraphData(Object.assign(Object.assign({},t),{style:Object.assign(Object.assign({},t.style),{radius:e.radius})}))}))}},{key:"handleFlowLineRelation",value:function(t){var e=this;t.forEach((function(t,n){var i=e.fcStore.findIndex(t.id1,xt.rect);e.fcStore.addRelation({lineId:t.id,linePos:"start",lineIndex:n,dir:t.dir1,graphId:t.id1,pointIndex:4*i+t.dir1});var r=e.fcStore.findIndex(t.id2,xt.rect);e.fcStore.addRelation({lineId:t.id,linePos:"end",lineIndex:n,dir:t.dir2,graphId:t.id2,pointIndex:4*r+t.dir2})}))}},{key:"onCopyGraphDragStart",value:function(t,e,n){this.copyIndex=n,this.copyData=e;var i=this.fGraph.getPosition(t.source).x;this.canCopy=i<=this.sideWidth}},{key:"onCopyGraphDragEnd",value:function(t,e){var n=this.fGraph.getPosition(t.source,e);if(this.canCopy&&n.x>this.sideWidth){var i=Object.assign(Object.assign({},this.copyData),n);i=this.graphCalibAlign(i),this.appendGraph.emit(Object.assign({},i))}this.flowChange.emit(),t.source.reset(),this.copyIndex=null,this.copyData=null}},{key:"onDragGraphStart",value:function(t,e,n){this.moveIndex=n;var i=this.fGraph.getPosition(t.source).x;this.canCopy=i<=this.sideWidth}},{key:"onDragGraphEnd",value:function(t,e){var n=this.fGraph.getPosition(t.source);this.moveIndex=null,this.flowChange.emit();var i=this.graphCalibAlign(Object.assign(Object.assign({},e),n));this.setRelationLineByGraph(i)}},{key:"setRelationLineByGraph",value:function(t){var e=this,n=this.fcStore.getRelations((function(e){return e.graphId===t.id}));n.length>0&&n.forEach((function(t){var n=e.fcStore.find(t.lineId,xt.line),i=e.fcStore.getPoint(t.pointIndex);e.setLine(n,i,t.linePos,t.dir)}))}},{key:"graphCalibAlign",value:function(t){var e,n=!1,i=_createForOfIteratorHelper(this.fcStore.getAllGraphs());try{for(i.s();!(e=i.n()).done;){var r=e.value;if(t.id!==r.id){if(r.x+5>t.x&&r.x-5<t.x)return t.x=r.x,n=!0,this.setStoreData(t),t;if(r.y+5>t.y&&r.y-5<t.y)return t.y=r.y,n=!0,this.setStoreData(t),t}}}catch(o){i.e(o)}finally{i.f()}return n||this.setStoreData(t),t}},{key:"setStoreData",value:function(t){var e=this.fcStore.findIndex(t.id,t.type);e>-1?this.fcStore.set(e,t):this.fcStore.add(t)}},{key:"onDragLinePointStart",value:function(t,e){var n=this.fcStore.findRelationIndex((function(n){return n.lineId===e.id&&n.linePos===t.linePos}));n>-1&&this.fcStore.removeRelation(n)}},{key:"onDragLinePointEnd",value:function(t,e,n){var i=this.fGraph.getPosition(t.source);this.flowChange.emit(),this.setRelation(i,e,n,t.linePos,!0)}},{key:"onDragGraphPointStart",value:function(t){this.selectedLine=null,this.linePrePos=this.lineStartPos=this.fGraph.getPosition(t.source.element.nativeElement.parentElement.parentElement);var e=this.fcStore.add(this.fGraph.drawLine({x1:t.data.x+this.lineStartPos.x,y1:t.data.y+this.lineStartPos.y,x2:t.data.x+this.lineStartPos.x,y2:t.data.y+this.lineStartPos.y,dir1:t.data.direction,dir2:(t.data.direction+2)%4,type:xt.line}));this.lineIndex=this.fcStore.findIndex(e.id,e.type)}},{key:"onDragGraphPointEnd",value:function(t){var e=this.fcStore.get(this.lineIndex,xt.line),n=this.fGraph.getPosition(t.source,this.lineStartPos),i=this.setRelation(n,e,this.lineIndex,"end",!0);i&&(e.dir2=i?i.dir:e.dir2,this.setLine(e,i.point)),this.flowChange.emit(),t.source.reset(),n=this.fGraph.getPosition(t.source,this.lineStartPos),this.setRelation(n,e,this.lineIndex,"start"),this.lineStartPos=null,this.lineIndex=null}},{key:"onDragGraphPointMove",value:function(t){var e=this.fGraph.getPosition(t.source,this.lineStartPos),n=this.fcStore.get(this.lineIndex,xt.line);this.setLine(n,e)}},{key:"setLine",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"end",i=arguments.length>3?arguments[3]:void 0;if("end"===n){t.x2=e.x,t.y2=e.y;var r=this.fGraph.getGraphData(Object.assign(Object.assign({},t),{x2:e.x,y2:e.y,dir2:i||t.dir2}));t.x=r.x,t.y=r.y,t.data=r.data,this.linePrePos=e}else if("start"===n){var o=i||this.fGraph.getDirection(this.linePrePos,e);t.x1=e.x,t.y1=e.y;var a=this.fGraph.getGraphData(Object.assign(Object.assign({},t),{dir1:o||t.dir1,dir2:t.dir2||(o+2)%4,x1:e.x,y1:e.y}));t.x=a.x,t.y=a.y,t.data=a.data}}},{key:"getGraphDirPoint",value:function(t,e){if(t)switch("diamond"===t.type&&(t.height=this.fGraph.getDiamondHeight(t.width)),e){case wt.bottom:return{x:t.x+t.width/2+1,y:t.y+t.height+1};case wt.left:return{x:t.x+1,y:t.y+t.height/2+1};case wt.right:return{x:t.x+t.width+1,y:t.y+t.height/2+1};case wt.top:return{x:t.x+t.width/2+1,y:t.y+1}}}},{key:"onSelectedGraph",value:function(t,e){this.selectedGraph=e}},{key:"setRelation",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this.fcStore.findPoint(t);if(o)return this.fcStore.addRelation({graphId:o.graph.id,dir:o.dir,lineId:e.id,linePos:i,lineIndex:n,pointIndex:o.pointIndex}),r&&(e["end"===i?"dir2":"dir1"]=o?o.dir:o["end"===i?"dir2":"dir1"],this.setLine(e,o.point,i)),this.changeRelation.emit("start"===i?[o.graph,e]:[e,o.graph]),o;var a=this.fGraph.getLabelCenterPosition(e);e.x=a.x,e.y=a.y}},{key:"onSelectedLine",value:function(t,e,n){this.selectedLine=n,this.menuSelectedGraph=e,this.selectedRelations=this.fcStore.getRelations((function(t){return t.lineId===e.id}))}},{key:"onClickCvs",value:function(t){2!==t.button&&(this.selectedGraph=null,this.selectedLine=null,this.selectedRelations=null,this.menuSelectedGraph=null)}},{key:"getRelationByGraph",value:function(t,e){return t?t.find((function(t){return t.graphId===e.id})):null}},{key:"onContextmenu",value:function(t){if(t.preventDefault(),2===t.button&&t.offsetX>this.sideWidth){var e=this.fcStore.findGraphByPoint({x:t.offsetX,y:t.offsetY});this.menuSelectedGraph=e||this.menuSelectedGraph,this.contextMenu.emit(t),this.contextPosition={x:t.clientX,y:t.clientY}}}},{key:"onMenuDelete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.menuSelectedGraph;t&&(this.fcStore.delete(t),this.flowChange.emit())}},{key:"getLine",value:function(t){return this.fcStore.find(t,xt.line)}},{key:"getGraph",value:function(t){return this.fcStore.find(t)}},{key:"getAllGraphs",value:function(){return this.fcStore.getAllGraphs()}},{key:"getAllLines",value:function(){return this.fcStore.getAllLines()}},{key:"setGraphData",value:function(t){this.fcStore.update(t)}},{key:"onMenuCopy",value:function(){this.clipboard=Object.assign({},this.menuSelectedGraph)}},{key:"onMenuPaste",value:function(){if(this.clipboard){var t=this.clipboard;(t.x||t.y)&&(t.x=t.x+20,t.y=t.y+20),(t.x1||t.y1)&&(t.x1=t.x1+20,t.y1=t.y1+20,t.x2=t.x2+20,t.y2=t.y2+20),this.flowChange.emit(),this.fcStore.add(Object.assign({},t))}}},{key:"onAddLabel",value:function(t){this.flowChange.emit(),this.dblclickLine.emit(this.menuSelectedGraph)}},{key:"onContextLine",value:function(t,e){2===t.button&&(this.menuSelectedGraph=e)}},{key:"mode",set:function(t){this.isEditMode="edit"===t}},{key:"nzoModelGraphs",set:function(t){this.modalGraphs=this.handleData(t)}},{key:"nzoFlowData",set:function(t){var e=this;if(this.fcStore.clear(),t&&t.length>0){var n=[],i=[];t.forEach((function(t){t.type===xt.line?n.push(Object.assign(Object.assign({},t),{x:t.x2})):i.push(Object.assign(Object.assign({},t),{style:Object.assign(Object.assign({},t.style),{radius:e.radius})}))})),this.fcStore.addAllGraphs(i),this.fcStore.addAllLines(n),this.handleFlowLineRelation(n)}}}]),t}()).\u0275fac=function(t){return new(t||le)(c.Sb(Et),c.Sb(St))},le.\u0275cmp=c.Mb({type:le,selectors:[["nzo-flowchart"]],viewQuery:function(t,e){var n;1&t&&(c.Rc(Jt,!0),c.Rc(dt,!0)),2&t&&(c.yc(n=c.hc())&&(e.rootCvs=n.first),c.yc(n=c.hc())&&(e.cdkDrags=n))},inputs:{radius:["nzoRadius","radius"],borderWidth:["nzoBorderWidth","borderWidth"],fontSize:["nzoFontSize","fontSize"],sideWidth:["nzoSideWidth","sideWidth"],header:["nzoHeader","header"],mode:["nzoMode","mode"],nzoModelGraphs:"nzoModelGraphs",nzoFlowData:"nzoFlowData"},outputs:{flowChange:"nzoFlowChange",dblclickGraph:"nzoGraphDblclick",dblclickLine:"nzoLineDblclick",contextMenu:"nzoContextMenu",appendGraph:"nzoAppendGraph",changeRelation:"nzoChangeRelation"},features:[c.Ab],decls:16,vars:11,consts:[[1,"nzo-fc-header"],[4,"ngTemplateOutlet"],[1,"nzo-fc-container",3,"mousedown","contextmenu"],["width","100%",0,"xmlns","svg","http://www.w3.org/1999/XSL/Transform","xmlns","http://www.w3.org/2000/svg","height","100%"],["rootCvs",""],["id","markerArrow","markerWidth","8","markerHeight","8","refX","8","refY","4","orient","auto"],["d","M0,0A5,8,0,0,1,0,8L8,4z",2,"fill","#455ff7"],["transform","translate(0, 16)",4,"ngIf"],["y1","0","y2","100%","stroke","#e6e9ed","stroke-width","1",4,"ngIf"],["nzo-graph","",3,"nzoData","nzoPoint","nzoDragDisabled","nzoSelected",4,"ngFor","ngForOf"],["nzo-line","",3,"nzoData","nzoDragDisabled","nzoSelected","nzoDblclick","nzoMousedown","nzoClick","nzoDragPointStarted","nzoDragPointEnded",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"nzoPosition","nzoDelete","nzoCopy","nzoPaste",4,"ngIf"],["transform","translate(0, 16)"],["nzo-graph","",3,"nzoData",4,"ngFor","ngForOf"],["nzo-graph-shadow","",3,"nzoData","nzoDragGraphStarted","nzoDragGraphEnded",4,"ngFor","ngForOf"],["nzo-graph","",3,"nzoData"],["nzo-graph-shadow","",3,"nzoData","nzoDragGraphStarted","nzoDragGraphEnded"],["y1","0","y2","100%","stroke","#e6e9ed","stroke-width","1"],["nzo-graph","",3,"nzoData","nzoPoint","nzoDragDisabled","nzoSelected"],["nzo-line","",3,"nzoData","nzoDragDisabled","nzoSelected","nzoDblclick","nzoMousedown","nzoClick","nzoDragPointStarted","nzoDragPointEnded"],["nzo-graph-shadow","",3,"nzoData","nzoPoint","nzoSelected","nzoSelectedRelation","nzoClick","nzoDblclick","nzoDragGraphStarted","nzoDragGraphEnded","nzoDragPointStarted","nzoDragPointMoved","nzoDragPointEnded",4,"ngFor","ngForOf"],["nzo-graph-shadow","",3,"nzoData","nzoPoint","nzoSelected","nzoSelectedRelation","nzoClick","nzoDblclick","nzoDragGraphStarted","nzoDragGraphEnded","nzoDragPointStarted","nzoDragPointMoved","nzoDragPointEnded"],[3,"nzoPosition","nzoDelete","nzoCopy","nzoPaste"]],template:function(t,e){1&t&&(c.Yb(0,"div",0),c.Kc(1,Qt,1,0,"ng-container",1),c.Xb(),c.Yb(2,"div",2),c.gc("mousedown",(function(t){return e.onClickCvs(t)}))("contextmenu",(function(t){return e.onContextmenu(t)})),c.jc(),c.Yb(3,"svg",3,4),c.Yb(5,"defs"),c.Yb(6,"marker",5),c.Tb(7,"path",6),c.Xb(),c.Xb(),c.Kc(8,ne,3,2,"g",7),c.Kc(9,ie,1,2,"line",8),c.Kc(10,re,1,4,"g",9),c.lc(11,"async"),c.Kc(12,oe,1,3,"g",10),c.lc(13,"async"),c.Kc(14,se,3,3,"ng-container",11),c.Xb(),c.Xb(),c.Kc(15,ce,1,1,"nzo-contextmenu",12)),2&t&&(c.Cb(1),c.sc("ngTemplateOutlet",e.header),c.Cb(7),c.sc("ngIf",e.isEditMode),c.Cb(1),c.sc("ngIf",e.isEditMode),c.Cb(1),c.sc("ngForOf",c.mc(11,7,e.flow.graphs$)),c.Cb(2),c.sc("ngForOf",c.mc(13,9,e.flow.lines$)),c.Cb(2),c.sc("ngIf",e.isEditMode),c.Cb(1),c.sc("ngIf",e.isEditMode))},directives:[i.A,i.t,i.s,Ft,qt,Mt,Ut],pipes:[i.b],styles:[".nzo-fc-header{min-height:48px;border-bottom:1px solid #e6e9ed}.nzo-fc-container{width:100%;height:600px;display:flex;border-bottom:1px solid #e6e9ed}.nzo-fc-container .nzo-fc-panel{width:15%;background-color:#fff;display:flex;justify-content:center;border-radius:4px;box-shadow:2px 0 8px rgba(0,0,0,.15)}.nzo-fc-container .nzo-fc-rect-box{cursor:-webkit-grab;cursor:grab}.nzo-fc-container .nzo-fc-rect-box:hover .nzo-fc-connect-point{display:inline-block}.nzo-fc-container circle{cursor:crosshair}.nzo-fc-container .nzo-fc-canvas{width:85%}.nzo-fc-container svg text{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.nzo-fc-container .nzo-fc-drag{position:relative;z-index:1}.nzo-fc-container .nzo-fc-point{display:none}.nzo-fc-container .nzo-fc-point .active{display:inline-block}.nzo-fc-container .nzo-fc-connect-point{display:none}.nzo-fc-container .nzo-fc-line{cursor:pointer}.nzo-fc-container .nzo-fc-line:hover .nzo-fc-connect-point{display:inline-block}.nzo-fc-container .nzo-fc-line circle{position:relative;z-index:1}.nzo-fc-container ::ng-deep .cdk-drag-placeholder{opacity:0}.nzo-fc-container ::ng-deep .cdk-drag-animating,.nzo-fc-container ::ng-deep .cdk-drop-list-dragging .nzo-fc-drag:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],encapsulation:2}),le),ve=[Et,St],ye=((he=function t(){_classCallCheck(this,t)}).\u0275mod=c.Qb({type:he}),he.\u0275inj=c.Pb({factory:function(t){return new(t||he)},providers:[ve],imports:[[i.c,gt]]}),he),_e=n("He08"),be=n("dNxI"),me=n("9QfB"),De=[{path:"",pathMatch:"full",redirectTo:"flow"},{path:"flow",component:(ue=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){this.graphs=[{type:xt.ellipse,text:"\u5f00\u59cb",width:68,height:30,style:{color:"#1590ff"},params:{},x:20},{type:xt.ellipse,text:"\u7ed3\u675f",width:68,height:30,style:{color:"#1590ff"},params:{},x:20,y:50},{type:xt.rect,text:"\u6570\u636e",width:68,height:30,style:{color:"#65ddd5"},params:{},x:20,y:100},{type:xt.rect,text:"\u7c7b\u578b",width:68,height:30,style:{color:"#b786ec"},params:{},x:20,y:150},{type:xt.rect,text:"\u53c2\u6570",width:68,height:30,style:{color:"#faad14"},params:{},x:20,y:200},{type:xt.diamond,text:"\u5224\u65ad",width:68,style:{color:"#777"},params:{},x:20,y:250}]}},{key:"svgCanvas",value:function(){}},{key:"generate",value:function(){}}]),t}(),ue.\u0275fac=function(t){return new(t||ue)},ue.\u0275cmp=c.Mb({type:ue,selectors:[["nzo-flow"]],decls:4,vars:1,consts:[["title","\u6d41\u7a0b\u7f16\u8f91\u5668"],[3,"nzoModelGraphs"]],template:function(t,e){1&t&&(c.Yb(0,"nzo-page-layout"),c.Tb(1,"nzo-page-header",0),c.Yb(2,"nzo-page-content"),c.Tb(3,"nzo-flowchart",1),c.Xb(),c.Xb()),2&t&&(c.Cb(3),c.sc("nzoModelGraphs",e.graphs))},directives:[_e.a,be.a,me.a,pe],styles:["nzo-flowchart[_ngcontent-%COMP%]{display:block;margin:-24px}.drag-box[_ngcontent-%COMP%]{width:50px;height:50px;background-color:#eee;box-shadow:1px 0 3px #aaa}"]}),ue)},{path:"mind",component:(de=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}(),de.\u0275fac=function(t){return new(t||de)},de.\u0275cmp=c.Mb({type:de,selectors:[["nzo-mind"]],decls:2,vars:0,template:function(t,e){1&t&&(c.Yb(0,"p"),c.Mc(1," mind works!\n"),c.Xb())},styles:[""]}),de)}],ke=((fe=function t(){_classCallCheck(this,t)}).\u0275mod=c.Qb({type:fe}),fe.\u0275inj=c.Pb({factory:function(t){return new(t||fe)},imports:[[r.h.forChild(De)],r.h]}),fe),xe=n("PCNd"),we=((ge=function t(){_classCallCheck(this,t)}).\u0275mod=c.Qb({type:ge}),ge.\u0275inj=c.Pb({factory:function(t){return new(t||ge)},imports:[[i.c,ke,xe.a,gt,ye]]}),ge)}}]);